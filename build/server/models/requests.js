// Generated by CoffeeScript 1.7.1
var allAccessesLike, allByBank, allByBankAccess, allByBankAccount, allByBankAccountAndDate, allByBankAccountAndType, allByName, allByTitle, allOperationsLike, allReportsByFrequency, americano, byUuid, getBalance, getBanksWithAccounts;

americano = require('americano');

allByName = function(doc) {
  return emit(doc.name, doc);
};

byUuid = function(doc) {
  return emit(doc.uuid, doc);
};

allByTitle = function(doc) {
  return emit(doc.title, doc);
};

allByBank = function(doc) {
  return emit(doc.bank, doc);
};

allByBankAccess = function(doc) {
  return emit(doc.bankAccess, doc);
};

allByBankAccount = function(doc) {
  return emit(doc.bankAccount, doc);
};

allReportsByFrequency = function(doc) {
  return emit([doc.type, doc.frequency], doc);
};

allByBankAccountAndType = function(doc) {
  return emit([doc.bankAccount, doc.type], doc);
};

allByBankAccountAndDate = function(doc) {
  return emit([doc.bankAccount, doc.date], doc);
};

allAccessesLike = function(doc) {
  return emit([doc.bank, doc.login, doc.password], doc);
};

allOperationsLike = function(doc) {
  return emit([doc.bankAccount, doc.date, doc.amount.toFixed(2), doc.raw], doc);
};

getBalance = {
  map: function(doc) {
    return emit(doc.bankAccount, doc.amount);
  },
  reduce: function(keys, values, rereduce) {
    return sum(values);
  }
};

getBanksWithAccounts = {
  map: function(doc) {
    return emit(doc.bank, 1);
  },
  reduce: function(keys, values, rereduce) {
    return 1;
  }
};

module.exports = {
  bank: {
    all: allByName,
    byUuid: byUuid
  },
  bankaccess: {
    all: americano.defaultRequests.all,
    allByBank: allByBank,
    allLike: allAccessesLike
  },
  bankaccount: {
    all: allByTitle,
    allByBankAccess: allByBankAccess,
    allByBank: allByBank,
    bankWithAccounts: getBanksWithAccounts
  },
  bankoperation: {
    all: americano.defaultRequests.all,
    allByBankAccount: allByBankAccount,
    allByBankAccountAndDate: allByBankAccountAndDate,
    allLike: allOperationsLike,
    getBalance: getBalance
  },
  bankalert: {
    all: americano.defaultRequests.all,
    allByBankAccount: allByBankAccount,
    allReportsByFrequency: allReportsByFrequency,
    allByBankAccountAndType: allByBankAccountAndType
  }
};
